<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>BHA Diagram - Horizontal with Tooltips</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
</head>
<body style="margin:0">
  <div id="bhaHorizontal" style="width: 100%; height: 400px;"></div>

  <script>
    const baseY = 150;
    const baseX = 50;
    const height = 60;
    let currentX = baseX;

    const components = [
      {
        name: 'Drillpipe',
        width: 80,
        color: '#A0A0A0',
        description: 'Drillpipe: Long tubular sections transmitting torque and fluid.'
      },
      {
        name: 'Crossover Sub',
        width: 60,
        color: '#8888CC',
        description: 'Crossover Sub: Connects different tool joints.'
      },
      {
        name: 'Drill Collar',
        width: 100,
        color: '#FFD700',
        description: 'Drill Collar: Adds weight on bit and stiffness to avoid deviation.'
      },
      {
        name: 'Stabilizer',
        width: 80,
        description: 'Stabilizer: Centralizes BHA and controls trajectory.',
        render: (x, y, w, h) => ({
          type: 'path',
          shape: {
            pathData: `
              M${x + w/2 - 15},${y}
              L${x + w/2 + 15},${y}
              L${x + w},${y + h/2}
              L${x + w/2 + 15},${y + h}
              L${x + w/2 - 15},${y + h}
              L${x},${y + h/2}
              Z
            `
          },
          style: { fill: '#32CD32', stroke: '#000' }
        })
      },
      {
        name: 'Reamer',
        width: 80,
        description: 'Reamer: Enlarges wellbore diameter or conditions it.',
        render: (x, y, w, h) => ({
          type: 'path',
          shape: {
            pathData: `
              M${x},${y + h}
              L${x + w/4},${y}
              L${x + 3*w/4},${y}
              L${x + w},${y + h}
              Z
            `
          },
          style: { fill: '#FF8C00', stroke: '#000' }
        })
      },
      {
        name: 'Bit',
        width: 90,
        description: 'Bit: Breaks rock and drills the formation.',
        render: (x, y, w, h) => ({
          type: 'group',
          children: [
            {
              type: 'rect',
              shape: { x, y, width: w, height: h - 10 },
              style: { fill: '#DC143C', stroke: '#000' }
            },
            {
              type: 'path',
              shape: {
                pathData: `
                  M${x},${y + h - 10}
                  L${x + w * 0.25},${y + h}
                  L${x + w * 0.5},${y + h - 5}
                  L${x + w * 0.75},${y + h}
                  L${x + w},${y + h - 10}
                  Z
                `
              },
              style: { fill: '#DC143C', stroke: '#000' }
            }
          ]
        })
      }
    ];

    const renderItems = [];

    components.forEach(comp => {
      const w = comp.width;
      const x = currentX;
      const y = baseY;

      const baseShape = comp.render
        ? comp.render(x, y, w, height)
        : {
            type: 'rect',
            shape: { x, y, width: w, height: height },
            style: { fill: comp.color || '#ccc', stroke: '#000' }
          };

      renderItems.push({
        type: 'group',
        children: [
          {
            ...baseShape,
            info: { name: comp.name, description: comp.description }
          },
          {
            type: 'text',
            style: {
              text: comp.name,
              x: x + w / 2,
              y: y + height / 2,
              textAlign: 'center',
              textVerticalAlign: 'middle',
              font: 'bold 13px sans-serif',
              fill: '#000'
            }
          }
        ]
      });

      currentX += w + 20;
    });

    const chart = echarts.init(document.getElementById('bhaHorizontal'));

    chart.setOption({
      title: {
        text: 'Bottom Hole Assembly (BHA) â€“ Horizontal Layout',
        left: 'center'
      },
      tooltip: {
        trigger: 'item',
        formatter: function (params) {
          const info = params?.data?.info;
          return info ? `<b>${info.name}</b><br/>${info.description}` : '';
        }
      },
      xAxis: { show: false, min: 0, max: currentX + 50 },
      yAxis: { show: false, min: 0, max: 400 },
      series: [{
        type: 'custom',
        renderItem: function (params, api) {
          return {
            type: 'group',
            children: renderItems.map(item => {
              const withData = { ...item.children[0], info: item.children[0].info };
              return {
                ...item,
                children: [withData, item.children[1]]
              };
            })
          };
        },
        data: renderItems
      }]
    });
  </script>
</body>
</html>
